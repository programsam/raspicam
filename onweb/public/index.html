<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dropcam</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script src="https://raw.github.com/phstc/jquery-dateFormat/master/dist/jquery-dateFormat.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<script>
	//https://s3.amazonaws.com/bensmith/dropcam/1444912499039.jpg
	      function refreshList() {
		   $.get( "/list", function( data ) {
				toAdd = "<ul>"
			  for (var j=0;j<data.length;j++)
			  {
				  var formatted = $.datepicker.formatDate("M d, yy", new Date(data[j].name));
				  toAdd += "<li><a href='javascript:viewImage(\"" + data[j].url + "\")'>" + formatted + "</a>" 
			  }
				toAdd += "</ul>"
				$("#list").html(toAdd)
				$("#viewing").attr('src', data[0].url)
			});
	   }
	   
	   function viewImage(url) {
		   $("#viewing").attr('src', url)
	   }
	   
	   setInterval(function() {
		   $.get( "/list", function( data ) {
				toAdd = "<ul>"
			  for (var j=0;j<data.length;j++)
			  {
				  var longDateFormat  = 'dd/MM/yyyy HH:mm:ss';
				  var displayDate = $.format.date(data[j].name, longDateFormat)
				  toAdd += "<li><a href='javascript:viewImage(\"" + data[j].url + "\")'>" + displayDate + "</a>" 
			  }
				toAdd += "</ul>"
				$("#list").html(toAdd)
				$("#viewing").attr('src', data[data.length-1].url)
			});
	   }, 60000);
	   refreshList();
	</script>
  </head>
<body>
<div class='row'>
	<div class='col-md-4'>
		<div id='list'></div>
	</div>
	<div class='col-md-8'>
		<img src='' id='viewing' />
	</div>
</div>
</body>
</html>